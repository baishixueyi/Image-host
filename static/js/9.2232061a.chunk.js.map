{"version":3,"sources":["components/Uploader.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Components","observer","useStore","imageStore","userStore","ref1","useRef","ref2","ref3","ref4","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","multiple","showUploadList","beforeUpload","file","currentUser","message","warning","console","log","test","type","size","error","setFilename","name","setFile","upload","then","serveFile","catch","style","marginTop","className","InboxOutlined","marginRight","ref","value","onFocus","current","select","target","href","filename","src","onChange","placeholder","fullStr","Home","Uploader"],"mappings":"oNAOQA,EAAYC,IAAZD,QAEFE,EAASC,IAAOC,IAAV,kGAKNC,EAAKF,IAAOG,GAAV,wEAIFC,EAAQJ,IAAOK,IAAV,kDAuGIC,EAnGEC,aAAS,WACtB,MAAiCC,cAAzBC,EAAR,EAAQA,WAAWC,EAAnB,EAAmBA,UACbC,EAAOC,mBACPC,EAAOD,mBACPE,EAAOF,mBACPG,EAAOH,mBACPI,EAAQC,aAAc,iBAAK,CAC7BC,MAAM,KACNC,SAF6B,SAEpBD,GACLF,EAAME,MAAQA,GAElB,eACI,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAE3CE,OAAO,KACPC,UAT6B,SASnBD,GACNJ,EAAMI,OAASA,GAEnB,gBACI,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE7C,cACI,OAAOX,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAgBR,EAAMS,SAAST,EAAMU,eAepGC,EAAQ,CACVC,UAAU,EACVC,gBAAe,EACfC,aAAa,SAAAC,GACT,OAA2B,OAAxBrB,EAAUsB,aACTC,IAAQC,QAAQ,+CACT,IAEXC,QAAQC,IAAIL,GAER,wCAAwCM,KAAKN,EAAKO,MAInDP,EAAKQ,KAAK,SACTN,IAAQO,MAAM,2CACP,IAEX/B,EAAWgC,YAAYV,EAAKW,MAC5BjC,EAAWkC,QAAQZ,GACnBtB,EAAWmC,SACVC,MAAK,SAACC,GACHX,QAAQC,IAAI,4BACZD,QAAQC,IAAIU,MACbC,OAAM,WACLZ,QAAQC,IAAI,gCAET,IAhBHH,IAAQO,MAAM,+EACP,MAkBnB,OACI,yBAAKQ,MAAO,CAACC,UAAU,SACnB,kBAACpD,EAAY8B,EACT,uBAAGuB,UAAU,wBACb,kBAACC,EAAA,EAAD,OAEA,uBAAGD,UAAU,mBAAb,gEACA,uBAAGA,UAAU,mBAAb,mGAICzC,EAAWa,WAAW,kBAACvB,EAAD,KACnB,kBAACG,EAAD,iCACA,4BACI,wDACA,4BAAI,2BAAO8C,MAAO,CAAC9B,MAAM,QAAQkC,YAAY,QAASC,IAAKvC,EAAMwC,MAAO7C,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,IAAK+B,QAnD5H,WACjBzC,EAAK0C,QAAQC,YAkDwJ,uBAAGC,OAAO,SAASC,KAAMlD,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,KAAzE,6BACrJ,kDACA,4BAAKf,EAAWmD,UAChB,wDACA,4BAAI,kBAACxD,EAAD,CAAOyD,IAAKpD,EAAWa,WAAWC,WAAWC,IAAID,WAAWC,OAChE,wDACA,4BACI,2BAAO6B,IAAK1C,EAAMmD,SAhEtB,WAChB9C,EAAMG,SAASR,EAAK6C,QAAQF,QA+DiCS,YAAY,qDACrD,2BAAOV,IAAKxC,EAAMiD,SA9DrB,WACjB9C,EAAMK,UAAUR,EAAK2C,QAAQF,QA6DiCS,YAAY,sDAE1D,4BAAI,2BAAOf,MAAO,CAAC9B,MAAM,QAAQkC,YAAY,QAASC,IAAKtC,EAAMuC,MAAOtC,EAAMgD,QAAST,QA1DrF,WAClBxC,EAAKyC,QAAQC,YAyDmH,uBAAGC,OAAO,SAASC,KAAM3C,EAAMgD,SAA/B,+BAE5G,S,SC9GtBC,EAAO1D,aAAS,WAClB,IAAQG,EAAeF,cAAfE,UACR,OACI,oCAEIA,EAAUsB,YAAY,qCAAM,kBAAC,IAAD,CAAOC,QAAQ,yDAAYK,KAAK,YAEhE,kBAAC4B,EAAD,UAKOD","file":"static/js/9.2232061a.chunk.js","sourcesContent":["import React, { useRef } from 'react'\nimport { useStore } from '../stores'\nimport { observer,useLocalStore } from 'mobx-react'\nimport { Upload, message } from 'antd';\nimport { InboxOutlined } from '@ant-design/icons';\nimport styled from 'styled-components'\n\nconst { Dragger } = Upload;\n\nconst Result = styled.div`\n    margin-top:30px;\n    border:1px dashed #ccc;\n    padding:20px;\n`\nconst H1 = styled.h1`\n    margin:20px 0;\n    text-align:center;\n`\nconst Image = styled.img`\n    max-width:300px;\n`\n\nconst Components=observer(()=>{\n    const { imageStore,userStore } = useStore()\n    const ref1 = useRef()\n    const ref2 = useRef()\n    const ref3 = useRef()\n    const ref4 = useRef()\n    const store = useLocalStore(()=>({\n        width:null,\n        setWidth(width){\n            store.width = width\n        },\n        get widthStr(){\n            return store.width?`/w/${store.width}`:''\n        },\n        height:null,\n        setHeight(height){\n            store.height = height\n        },\n        get heightStr(){\n            return store.height?`/h/${store.height}`:''\n        },\n        get fullStr(){\n            return imageStore.serverFile.attributes.url.attributes.url + '?imageView2/0'+store.widthStr+store.heightStr\n        }\n    }))\n    const handleWidth = ()=>{\n        store.setWidth(ref1.current.value)\n    }\n    const handleHeight = ()=>{\n        store.setHeight(ref2.current.value)\n    }\n    const handleSelect = ()=>{\n        ref3.current.select()\n    }\n    const handleSelect2 = ()=>{\n        ref4.current.select()\n    }\n    const props = {\n        multiple: true,\n        showUploadList:false,\n        beforeUpload:file=>{\n            if(userStore.currentUser===null){\n                message.warning('请先登录后上传')\n                return false\n            }\n            console.log(file)\n            //限制上传图片格式和大小\n            if(!/(png$)|(gif$)|(svg$)|(jpg$)|(jpeg$)/ig.test(file.type)){\n                message.error('只能上传png/gif/svg/jpg/jpeg格式的图片')\n                return false\n            }\n            if(file.size>2*1024*1024){\n                message.error('图片最大上传2M')\n                return false\n            }\n            imageStore.setFilename(file.name)\n            imageStore.setFile(file)\n            imageStore.upload()\n            .then((serveFile)=>{\n                console.log('上传成功')\n                console.log(serveFile)\n            }).catch(()=>{\n                console.log('上传失败')\n            })\n            return false\n        },\n    };\n    return (\n        <div style={{marginTop:'30px'}}>\n            <Dragger {...props}>\n                <p className=\"ant-upload-drag-icon\">\n                <InboxOutlined />\n                </p>\n                <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n                <p className=\"ant-upload-hint\">\n                   仅支持png/gif/svg/jpg/jpeg格式的图片，最大为2M\n                </p>\n            </Dragger>\n                {imageStore.serverFile?<Result>\n                    <H1>上传结果</H1>\n                    <dl>\n                        <dt>线上地址</dt>\n                        <dd><input style={{width:'420px',marginRight:'10px'}} ref={ref3} value={imageStore.serverFile.attributes.url.attributes.url} onFocus={handleSelect}/><a target=\"_blank\" href={imageStore.serverFile.attributes.url.attributes.url}>查看原图</a></dd>\n                        <dt>文件名</dt>\n                        <dd>{imageStore.filename}</dd>\n                        <dt>图片预览</dt>\n                        <dd><Image src={imageStore.serverFile.attributes.url.attributes.url}/></dd>\n                        <dt>更多尺寸</dt>\n                        <dd>\n                            <input ref={ref1} onChange={handleWidth} placeholder=\"最大宽度（可选）\"/>\n                            <input ref={ref2} onChange={handleHeight} placeholder=\"最大高度（可选）\"/>\n                        </dd>\n                        <dd><input style={{width:'550px',marginRight:'10px'}} ref={ref4} value={store.fullStr} onFocus={handleSelect2}/><a target=\"_blank\" href={store.fullStr}>查看图片</a></dd>\n                    </dl>\n                </Result> : null}\n        </div>\n    )\n})\n\nexport default Components","import React from 'react';\nimport { observer } from 'mobx-react'\nimport { useStore } from '../stores'\nimport Uploader from '../components/Uploader'\nimport { Alert } from 'antd';\n\nconst Home = observer(()=>{\n    const { userStore }  = useStore()\n    return (\n        <>\n        {\n            userStore.currentUser?<></>:<Alert message=\"请先登录后上传图片\" type=\"warning\" />\n        }\n        <Uploader/>\n        </>\n    )\n})\n\nexport default Home;"],"sourceRoot":""}